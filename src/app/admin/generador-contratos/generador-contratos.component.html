<!-- Formulario para generar contrato -->
<div
  class="p-6 bg-white dark:bg-gray-900 rounded-xl shadow-lg border border-green-300 max-w-2xl mx-auto mt-6"
>
  <h2 class="text-lg font-semibold text-green-800 dark:text-green-200 mb-4">
    Generar Contrato
  </h2>

  <form
    [formGroup]="contratoForm"
    (ngSubmit)="generarContrato()"
    class="bg-white dark:bg-gray-900 border border-green-300 shadow-lg rounded-xl p-6 space-y-5 max-w-2xl mx-auto"
  >
    <h2 class="text-lg font-semibold text-green-800 dark:text-green-200 mb-4">
      Generar Contrato
    </h2>

    <!-- Nombre completo -->
    <div>
      <label
        class="block text-sm font-medium text-green-800 dark:text-green-100 mb-1"
      >
        Nombre completo
      </label>
      <input
        formControlName="nombre"
        placeholder="Ej. Juan Pérez"
        class="w-full border border-green-300 rounded-md px-3 py-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-green-400"
      />
      <div
        *ngIf="
          contratoForm.get('nombre')?.touched &&
          contratoForm.get('nombre')?.errors
        "
        class="text-red-500 text-sm mt-1"
      >
        <div *ngIf="contratoForm.get('nombre')?.errors?.['required']">
          El nombre es obligatorio.
        </div>
        <div *ngIf="contratoForm.get('nombre')?.errors?.['pattern']">
          Solo se permiten letras y espacios.
        </div>
      </div>
    </div>

    <!-- DNI -->
    <div>
      <label
        class="block text-sm font-medium text-green-800 dark:text-green-100 mb-1"
      >
        DNI
      </label>
      <input
        formControlName="dni"
        placeholder="DNI"
        class="w-full border border-green-300 rounded-md px-3 py-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-green-400"
      />
      <div
        *ngIf="
          contratoForm.get('dni')?.touched && contratoForm.get('dni')?.errors
        "
        class="text-red-500 text-sm mt-1"
      >
        <div *ngIf="contratoForm.get('dni')?.errors?.['required']">
          El DNI es obligatorio.
        </div>
        <div *ngIf="contratoForm.get('dni')?.errors?.['pattern']">
          Debe tener exactamente 8 dígitos numéricos.
        </div>
      </div>
    </div>

    <!-- Fecha de nacimiento -->
    <div>
      <label
        class="block text-sm font-medium text-green-800 dark:text-green-100 mb-1"
      >
        Fecha de nacimiento
      </label>
      <input
        type="date"
        formControlName="nacimiento"
        class="w-full border border-green-300 rounded-md px-3 py-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-green-400"
      />
      <div
        *ngIf="
          contratoForm.get('nacimiento')?.touched &&
          contratoForm.get('nacimiento')?.errors
        "
        class="text-red-500 text-sm mt-1"
      >
        <div *ngIf="contratoForm.get('nacimiento')?.errors?.['required']">
          La fecha de nacimiento es obligatoria.
        </div>
        <div *ngIf="contratoForm.get('nacimiento')?.errors?.['menorDeEdad']">
          Debes ser mayor de 18 años.
        </div>
      </div>
    </div>

    <!-- Trabajo -->
    <div>
      <label
        class="block text-sm font-medium text-green-800 dark:text-green-100 mb-1"
      >
        Lugar de trabajo
      </label>
      <input
        formControlName="trabajo"
        placeholder="Ej. Municipalidad de Lima"
        class="w-full border border-green-300 rounded-md px-3 py-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-green-400"
      />
      <div
        *ngIf="
          contratoForm.get('trabajo')?.touched &&
          contratoForm.get('trabajo')?.errors
        "
        class="text-red-500 text-sm mt-1"
      >
        <div *ngIf="contratoForm.get('trabajo')?.errors?.['required']">
          Este campo es obligatorio.
        </div>
        <div *ngIf="contratoForm.get('trabajo')?.errors?.['maxlength']">
          Máximo 20 caracteres permitidos.
        </div>
      </div>
    </div>

    <!-- Monto -->
    <div>
      <label
        class="block text-sm font-medium text-green-800 dark:text-green-100 mb-1"
      >
        Monto del préstamo
      </label>
      <input
        formControlName="monto"
        type="number"
        placeholder="Ej. 2000"
        class="w-full border border-green-300 rounded-md px-3 py-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-green-400"
      />
      <div
        *ngIf="
          contratoForm.get('monto')?.touched &&
          contratoForm.get('monto')?.errors
        "
        class="text-red-500 text-sm mt-1"
      >
        <div *ngIf="contratoForm.get('monto')?.errors?.['required']">
          Campo obligatorio.
        </div>
        <div *ngIf="contratoForm.get('monto')?.errors?.['min']">
          Debe ser mayor a 0.
        </div>
      </div>
    </div>

    <!-- Cuotas -->
    <div>
      <label
        class="block text-sm font-medium text-green-800 dark:text-green-100 mb-1"
      >
        Número de cuotas
      </label>
      <input
        formControlName="cuotas"
        type="number"
        placeholder="Ej. 12"
        class="w-full border border-green-300 rounded-md px-3 py-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-green-400"
      />
      <div
        *ngIf="
          contratoForm.get('cuotas')?.touched &&
          contratoForm.get('cuotas')?.errors
        "
        class="text-red-500 text-sm mt-1"
      >
        <div *ngIf="contratoForm.get('cuotas')?.errors?.['required']">
          Campo obligatorio.
        </div>
        <div *ngIf="contratoForm.get('cuotas')?.errors?.['min']">
          Debe ser mayor a 0.
        </div>
      </div>
    </div>

    <!-- Día de pago -->
    <div>
      <label
        class="block text-sm font-medium text-green-800 dark:text-green-100 mb-1"
      >
        Día de pago
      </label>
      <input
        formControlName="diaPago"
        type="number"
        placeholder="Ej. 15"
        class="w-full border border-green-300 rounded-md px-3 py-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-green-400"
      />
      <div
        *ngIf="
          contratoForm.get('diaPago')?.touched &&
          contratoForm.get('diaPago')?.errors
        "
        class="text-red-500 text-sm mt-1"
      >
        <div *ngIf="contratoForm.get('diaPago')?.errors?.['required']">
          Campo obligatorio.
        </div>
        <div
          *ngIf="contratoForm.get('diaPago')?.errors?.['min'] || contratoForm.get('diaPago')?.errors?.['max']"
        >
          Debe estar entre 1 y 31.
        </div>
      </div>
    </div>

    <!-- Tasa de mora -->
    <div>
      <label
        class="block text-sm font-medium text-green-800 dark:text-green-100 mb-1"
      >
        Tasa de morosidad (%)
      </label>
      <input
        formControlName="tasaMora"
        type="number"
        step="0.01"
        placeholder="Ej. 3.5"
        class="w-full border border-green-300 rounded-md px-3 py-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-green-400"
      />
      <div
        *ngIf="
          contratoForm.get('tasaMora')?.touched &&
          contratoForm.get('tasaMora')?.errors
        "
        class="text-red-500 text-sm mt-1"
      >
        <div *ngIf="contratoForm.get('tasaMora')?.errors?.['required']">
          Campo obligatorio.
        </div>
        <div
          *ngIf="contratoForm.get('tasaMora')?.errors?.['min'] || contratoForm.get('tasaMora')?.errors?.['max']"
        >
          Debe estar entre 0.1% y 10%.
        </div>
      </div>
    </div>

    <!-- Botón de envío -->
    <div class="flex justify-end mt-6">
      <button
        type="submit"
        [disabled]="contratoForm.invalid"
        class="bg-green-600 hover:bg-green-700 text-white font-semibold px-6 py-2 rounded-md shadow transition"
      >
        Generar contrato
      </button>
    </div>
  </form>
</div>

<!-- Resultado del contrato generado -->
<div
  *ngIf="contratoGenerado"
  class="p-6 mt-6 bg-white dark:bg-gray-900 rounded-xl shadow-lg border border-green-300 max-w-2xl mx-auto"
>
  <h2 class="text-lg font-semibold text-green-800 dark:text-green-200 mb-2">
    Contrato generado:
  </h2>
  <pre
    class="bg-gray-100 dark:bg-gray-800 p-4 rounded-md text-gray-800 dark:text-gray-100 overflow-auto whitespace-pre-wrap"
    >{{ contratoGenerado }}
  </pre>
  <button
    (click)="descargarContratoDocAlternativo()"
    class="mt-4 bg-amber-600 text-white px-6 py-2 rounded-lg hover:bg-amber-700 transition duration-200"
  >
    Descargar Contrato
  </button>
</div>
